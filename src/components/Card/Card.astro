---
import type { CardServicePriceInfoProps } from "../../types/card";
import PriceInfo from "./PriceInfo.astro";

interface Props extends CardServicePriceInfoProps {}

const { image, orientation, prices, title } = Astro.props;
---

<article
  class="serviceCards px-5 my-20 md:px-10 lg:px20 flex flex-col min-h-[inherit]"
>
  <div class="title-container relative mb-5">
    <h1 class="text-4xl text-center">{title}</h1>
  </div>
  <div
    class={`flex flex-[1] gap-3 items-stretch  ${
      orientation === "left" ? "lg:flex-row" : "lg:flex-row-reverse"
    } flex-col`}
  >
    <section class="bg-[white] my-10 relative flex-[1]">
      <div
        class="w-full h-full bg-[black] animate-[image-transition_0.5s_ease-out] z-0"
      >
      </div>
      <img
        src={image}
        class="absolute top-[0] left-[0] object-cover h-full w-full animate-[image-transition_1s_ease-out] z-[1]"
        alt=""
      />
    </section>

    <section class="flex-[1] bg-card-background flex flex-col">
      {
        prices.map((info) => {
          return <PriceInfo {...info} />;
        })
      }
    </section>
  </div>
</article>

<script>
  const cards = document.querySelectorAll<HTMLElement>(".serviceCards");
  const cardShowedStatus: boolean[] = [];

  cards.forEach((card, i) => {
    card.style.opacity = "0";
    card.style.transform = "translateY(-50px)";
    cardShowedStatus.push(false);
    const observer = new IntersectionObserver((entries) => {
      const entry = entries[0];
      if (entry.isIntersecting && !cardShowedStatus[i]) {
        cardShowedStatus[i] = true;
        card.style.opacity = "1";
        card.style.transform = "translateY(0)";
      }
    });
    observer.observe(card);
  });
</script>

<style>
  .title-container::after {
    content: "";
    position: absolute;
    bottom: -5px;
    width: 100%;
    height: 2px;
    background-color: black;
  }
  .serviceCards {
    transition:
      opacity 1s ease,
      transform 1s ease;
  }
</style>
